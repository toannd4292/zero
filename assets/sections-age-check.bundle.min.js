import{a as e}from"./shared-import-js.cookie.bundle.min.js";document.addEventListener("alpine:init",(()=>{Alpine.data("ThemeSection_AgeCheck",(t=>({authenticated:!1,mode:t.mode,date_format:t.date_format,minimum_age:t.minimum_age,redirect_url:t.redirect_url,month:"",day:"",year:"",date:"",cookie:e.get("ageGateAuthenticated"),isSelected:!1,enabled:t.enabled,sectionId:t.sectionId,get fullDate(){return`${this.month}/${this.day}/${this.year}`},mounted(){"/challenge"!==window.location.pathname&&(initTeleport(this.$root),Alpine.store("modals").register("ageCheck","modal"),Shopify.designMode?(window.theme.designMode.selected===this.sectionId&&(!0===this.enabled?Alpine.store("modals").open("ageCheck"):Alpine.store("modals").close("ageCheck")),document.addEventListener("shopify:section:select",(e=>{e.target.contains(this.$root)&&this.enabled&&Alpine.store("modals").open("ageCheck")})),document.addEventListener("shopify:section:deselect",(e=>{e.target.contains(this.$root)&&this.$store.modals.close("ageCheck")}))):"true"!==this.cookie&&Alpine.store("modals").open("ageCheck"),null===this.redirect_url&&(this.redirect_url="https://www.google.com"),"dob"===this.mode&&(this.date=new Date,setTimeout((()=>this.setUpDOB()),100)))},approveEntry(){Alpine.store("modals").close("ageCheck"),this.isSelected?e.remove("ageGateAuthenticated"):e.set("ageGateAuthenticated","true",{expires:30})},denyEntry(){window.location=this.redirect_url},checkInput(e){switch(e){case"day":return parseInt(this.day)>0&&parseInt(this.day)<32;case"month":return parseInt(this.month)>0&&parseInt(this.month)<13;case"year":return parseInt(this.year)<this.date.getFullYear()&&parseInt(this.year)>1900}return!0},checkAge(){const e=Math.round(this.date.getTime()/1e3),t=Math.round(new Date(`${this.fullDate}`).getTime()/1e3);Math.floor((e-t)/31536e3)>parseInt(this.minimum_age,10)?this.approveEntry():this.denyEntry()},setUpDOB(){document.getElementById("dob-form").addEventListener("input",(e=>{const t=e.srcElement||e.target,i=parseInt(t.attributes.maxlength.value,10),n=t.value.length;if(n>=i){if(!this.checkInput(t.getAttribute("name")))return t.value="",!1;let e=t.closest(".input-grid-item");for(;(e=e.nextElementSibling)&&null!=e;){let t=e.querySelector("input");if(null!==t){t.focus();break}}}else if(0===n){let e=t.closest(".input-grid-item");for(;(e=e.previousElementSibling)&&null!=e;){const t=e.querySelector("input");if(null!==t){t.focus();break}}}this.checkInput("day")&&this.checkInput("month")&&this.checkInput("year")&&setTimeout((()=>this.checkAge()),500)}))}})))}));
